<!DOCTYPE html>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.1.1/css/bootstrap-combined.min.css" type="text/css" charset="utf-8">
    <title>Bingo</title>
    
    <style type="text/css">
        body * { font-family: Palatino, Georgia, serif;}
        #board {
/*            background-color: #334;*/
            border-radius: 10px;
        }
/*        .selected { background: #C2A5CF }
        .unselected { background: #F7F7F7 }
*/        .bingo-cell, .bingo-center {
            width: 10em;
            height: 8em;
            border-radius: 5px;
            display: inline-block;
            margin: 0.2em;
            vertical-align: middle;
            font-size: 11pt;
        }
/*        .bingo-center { background: #C2A5CF; color: #fff }*/
    </style>
</head>
<body onload="">
    <div class="container">
        <div class="offset1 span10">
            <div id="board"></div>
        </div>
    </div>
        <div class="span4 offset5" style="text-align:center">
            <a class="btn btn-info" href="?board=warelab">Ware Lab</a>
            <a class="btn btn-info" href="?board=kbase">KBase</a>
        </div>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" charset="utf-8">
function getParameterByName(name) {
    name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]"); // Sanitize
    var regexS = "[\\?&;]" + name + "(=[^&;#]*)?";
    var regex = new RegExp(regexS);
    var results = regex.exec(window.location.search);
    if (results == null) return "";
    if (results[1] == null) return true; // Query keyword
    return decodeURIComponent(results[1].substr(1).replace(/\+/g, " "));
}
$(function () {
    jQuery.fn.center = function() {
        this.css("top", $(window)
            .height() / 2 - this.height() / 2 + "px");
        this.css("left", $(window)
            .width() / 2 - this.width() / 2 + "px");
        return this;
    }
    var boardType = getParameterByName('board') || 'warelab';
    var url = "http://api.openkeyval.org/" + boardType + "_bingo";
    $.ajax({
        url: url,
        dataType: 'jsonp',
        success: function (json) {
            var dim = 5;
            var board = new Array();
            for (var i = 0; i < dim; i++) {
                var row = new Array();
                for (var j = 0; j < dim; j++) {
                    row.push(null);
                }
                board.push(row);
            }
            var options = json.split(/;/);
            var target = $("#board");
            target.empty();
            for (var i=0; i < board.length; i++) {
                var row = $('<div></div>');
                row.addClass("bingo-row");
                for (var j = 0; j < board[i].length; j++) {
                    var col = $("<button></button>");
                    col.addClass("btn");
                    col.addClass("btn-large");
                    col.addClass("btn-block");
                    if (i == 2 && j == 2) {
                        col.html("Free Square!");
                        col.addClass("bingo-center");
                        col.addClass("disabled");
                        col.addClass("btn-danger");
                    } else {
                        var index = Math.floor(Math.random() * (options.length - 1));
                        var str = options.splice(index, 1);
                        col.html(str);
                        col.addClass("bingo-cell");
                        col.addClass("unselected");
                    }
                    row.append(col);
                }
                target.append(row);
            };
            $(".bingo-row").center();
            $("#board .bingo-cell").on('click', function () {
                $(this).toggleClass('btn-danger');
            });
        }
    });
})
</script>
</body>
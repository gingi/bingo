<!DOCTYPE html>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.1.1/css/bootstrap-combined.min.css" type="text/css" charset="utf-8">
    <title>Bingo</title>
    
    <style type="text/css">
        body * { font-family: Palatino, Georgia, serif;}
        #board {
/*            background-color: #334;*/
            border-radius: 10px;
        }
/*        .selected { background: #C2A5CF }
        .unselected { background: #F7F7F7 }
*/        .bingo-cell, .bingo-center {
            width: 10em;
            height: 8em;
            border-radius: 5px;
            display: inline-block;
            margin: 0.2em;
            vertical-align: middle;
            font-size: 11pt;
        }
/*        .bingo-center { background: #C2A5CF; color: #fff }*/
    </style>
</head>
<body onload="">
    <div class="container">
        <div class="offset1 span10">
            <div id="board"></div>
        </div>
    </div>
    <div class="span4 offset6">
        <ul class="nav nav-pills" style="text-align:center">
            <li class="active">
                <a href="#" data-board="warelab">Ware Lab</a>
            </li>
            <li><a href="#" data-board="kbase">KBase</a></li>
        </ul>
    </div>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" charset="utf-8">
$(function () {
    function bingo(boardType) {
        var url = "http://api.openkeyval.org/" + boardType + "_bingo";
        $.ajax({
            url: url,
            dataType: 'jsonp',
            success: function (json) {
                var dim = 5;
                var board = new Array();
                for (var i = 0; i < dim; i++) {
                    var row = new Array();
                    for (var j = 0; j < dim; j++) {
                        row.push(null);
                    }
                    board.push(row);
                }
                var options = json.split(/;/);
                var target = $("#board");
                target.empty();
                for (var i=0; i < board.length; i++) {
                    var row = $('<div></div>');
                    row.addClass("bingo-row");
                    for (var j = 0; j < board[i].length; j++) {
                        var col = $("<button></button>");
                        col.addClass("btn");
                        col.addClass("btn-large");
                        col.addClass("btn-block");
                        if (i == 2 && j == 2) {
                            col.html("Free Square!");
                            col.addClass("bingo-center");
                            col.addClass("disabled");
                            col.addClass("btn-danger");
                        } else {
                            var index = Math.floor(Math.random() * (options.length - 1));
                            var str = options.splice(index, 1);
                            col.html(str);
                            col.addClass("bingo-cell");
                            col.addClass("unselected");
                        }
                        row.append(col);
                    }
                    target.append(row);
                };
                $("#board .bingo-cell").on('click', function () {
                    $(this).toggleClass('btn-danger');
                });
            }
        });
    }
    var selected = null;
    $("[data-board]").on('click', function () {
        bingo($(this).data('board'));
        if (selected != null) {
            selected.removeClass('active');
        }
        selected = $(this).parent();
        selected.addClass('active');
    })
    selected = $(".active > [data-board]").parent();
    bingo("warelab");
})
</script>
</body>